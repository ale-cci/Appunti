#!/usr/bin/env sh
set -e

PDFDIR="$PWD/pdf"
LOCAL_PDF_DIR="$HOME/pdfs/NOTE"

build_pdfs() {
    mkdir -p pdf
    mkpdf="pdflatex -output-directory $PDFDIR"

    echo "Building Elettronica..."
    (cd elettronica && $mkpdf elettronica.tex >/dev/null)

    echo "Building SDT..."
    $mkpdf sdt.tex >/dev/null

    echo "Building FCA..."
    (cd fca && $mkpdf fca.tex >/dev/null)
}

case "$1" in
    "pdf")
        build_pdfs

        printf "\nFile creadted:\n"
        ls -1X "$PDFDIR"/*.pdf
        ;;

    "clean")
        (cd elettronica && rm -f *.pdf *.log *.aux)
        rm -f *.pdf *.log *.aux
        (cd fca && rm -f *.pdf *.log *.aux)
        rm $PDFDIR/*.log $PDFDIR/*.aux
        ;;

    "sync")
        mkdir -p $LOCAL_PDF_DIR
        ln -t "$LOCAL_PDF_DIR" "$PDFDIR"/*.pdf
        ;;
esac

